<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
        }

        canvas {
            display: block;
            position: absolute;
        }
    </style>
</head>

<body>
    <div style="background-color: gray;">
        <canvas id="matrixCanvas"></canvas>
        <canvas id="canvas"></canvas>
    </div>

    <script src="./js/gsap.min.js"></script>
    <script src="./js/ScrollTrigger.min.js"></script>
    <script>
         function resizeCanvas(cnv, ct) {
            const dpr = window.devicePixelRatio || 1;
            cnv.width = window.innerWidth * dpr;
            cnv.height = window.innerHeight * dpr;
            cnv.style.width = window.innerWidth + "px";
            cnv.style.height = window.innerHeight + "px";
            ct.scale(dpr, dpr);  // 缩放绘图坐标系
        }
    </script>
    <script>
        const matrixCanvas = document.getElementById('matrixCanvas');
        const matrixCanvasCtx = matrixCanvas.getContext('2d');


        resizeCanvas(matrixCanvas, matrixCanvasCtx);
        function drawMatrix(space = 30, w, h) {
            matrixCanvasCtx.fillStyle = "#111";
            matrixCanvasCtx.fillRect(0, 0, w, h);

            const centerX = w / 2;
            const centerY = h / 2;

            const startX = centerX - Math.floor(centerX / space) * space;
            const startY = centerY - Math.floor(centerY / space) * space;

            const rows = Math.ceil(h / space);
            const cols = Math.ceil(w / space);

            for (let row = -rows; row <= rows; row++) {
                for (let col = -cols; col <= cols; col++) {
                    const x = centerX + col * space;
                    const y = centerY + row * space;

                    if (x >= 0 && x < w && y >= 0 && y < h) {
                        matrixCanvasCtx.fillStyle = "white";
                        matrixCanvasCtx.beginPath();
                        matrixCanvasCtx.arc(x, y, 1, 0, Math.PI * 2);
                        matrixCanvasCtx.fill();
                    }
                }
            }
        }
        // drawMatrix(30, 1920, 1080)
    </script>

    <script>
     
     const canvas = document.getElementById('canvas');
     const ctx = canvas.getContext('2d');
       

        resizeCanvas(canvas, ctx);

        function draw(radius) {
            
            const cw = window.innerWidth;
            const ch = window.innerHeight;
            ctx.fillStyle = 'blue';
            ctx.fillRect(0, 0, cw, ch);
            ctx.globalCompositeOperation = 'destination-out';
            ctx.beginPath();
            ctx.arc(cw / 2, ch / 2, radius, 0, Math.PI * 2);
            ctx.fill();
            ctx.globalCompositeOperation = 'source-over';
        }

        const circle = {
            radius: 100,
            w: window.innerWidth,
            h: window.innerHeight,
            space: 30
        }

        draw(circle.radius)

        gsap.to(circle, {
            radius: 500,
            space: 40,
            duration: 2,
            ease: "power1.inOut",
            onUpdate: () => {
                draw(circle.radius)
                drawMatrix(circle.space, circle.w, circle.h)
            }
        })


    </script>
</body>

</html>